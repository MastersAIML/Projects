<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.4 (456999)"/><meta name="altitude" content="889.7083740234375"/><meta name="author" content="montygupta@gmail.com"/><meta name="created" content="2018-06-06 00:02:17 +0000"/><meta name="latitude" content="12.95902828848507"/><meta name="longitude" content="77.647885993671"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-06-23 15:51:35 +0000"/><title>Linear Regression</title></head><body><div><span style="color: rgb(135, 135, 135); font-family: Lato, sans-serif; font-size: 14px; font-style: italic; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 254, 226); text-decoration-style: initial; text-decoration-color: initial; float: none;">The two main important differences between logistic and linear regression are: 1. Dependent/response variable in linear regression is continuous whereas, in logistic regression, it is the discrete type. 2. Cost function in linear regression minimise the error term Sum(Actual(Y)-Predicted(Y))^2 but logistic regression uses maximum likelihood method for maximising probabilities.</span><br/></div><div><span style="color: rgb(135, 135, 135); font-family: Lato, sans-serif; font-size: 14px; font-style: italic; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 254, 226); text-decoration-style: initial; text-decoration-color: initial; float: none;"><br/></span></div><div><span style="color: rgb(135, 135, 135); font-family: Lato, sans-serif; font-size: 14px; font-style: italic; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 254, 226); text-decoration-style: initial; text-decoration-color: initial; float: none;"><br/></span></div><div><br/></div><div>Closed Form Method vs Gradient Descent</div><div>Closed Form Method - Minimise cost function (usually derivatives)</div><div>Gradient Descent - Iterative - Cost Function Becoming lesser and lesser using Gradient</div><div><br/></div><div><a href="https://www.mathsisfun.com/equation_of_line.html">https://www.mathsisfun.com/equation_of_line.html</a><br/></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial; float: none;">The independent variable is also known as the </span><strong style="box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;">predictor variable</strong><span style="color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial; float: none;">. And the dependent variables are also known as the </span><strong style="box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;">output variables</strong><span style="color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial; float: none;">.</span><br/></div><div><br/></div><div><br/></div><div>ei = yi - ypred</div><div>Ordinary Least Squares Method:</div><div>e1^2 + e2^2 …..= RSS (Residual Sum of Squares)</div><div><br/></div><div>Differentiation</div><div>Gradient Descend model</div><div><br/></div><div>R-squared</div><div>RSS</div><div><span style="color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial; float: none;">RSE (Residual Square Error) = sq root ( RSS/n-2)</span><br/></div><div>TSS (Total Sum of Squares)</div><div><br/></div><div>R2 = 1 - RSS/TSS</div><div><br/></div><div><br/></div><div><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; padding: 9.5px; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px; font-weight: normal; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box; color: rgb(0, 136, 0); font-weight: bold;">from</span> <span style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">sklearn.cross_validation</span> <span style="box-sizing: border-box; color: rgb(0, 136, 0); font-weight: bold;">import</span> train_test_split
X_train, X_test, y_train, y_test <span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span> train_test_split(X, y, train_size<span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span><span style="box-sizing: border-box; color: rgb(102, 0, 238); font-weight: bold;">0.7</span> , random_state<span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span><span style="box-sizing: border-box; color: rgb(0, 0, 221); font-weight: bold;">100</span>)
</pre></div><div><br/></div><div><br/></div><div><p style="box-sizing: border-box; font-size: 16px; font-weight: 300; word-wrap: break-word; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><b style="box-sizing: border-box; font-weight: 700;">The generic process to build a model in sklearn can be divided into the following steps:</b></p><div><ul style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><b style="box-sizing: border-box; font-weight: 700;">Create X_train, y_train, X_test and Y_test</b></li></ul></div><div style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><div style="box-sizing: border-box;"><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; padding: 9.5px; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px; font-weight: normal; font-style: normal;"><span style="box-sizing: border-box; color: rgb(136, 136, 136);"># 1. Create the datasets X_train, y_train, X_test and y_test</span>
X_train, X_test, y_train, y_test <span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span> train_test_split(X, y, train_size<span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span><span style="box-sizing: border-box; color: rgb(102, 0, 238); font-weight: bold;">0.7</span> , random_state<span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span><span style="box-sizing: border-box; color: rgb(0, 0, 221); font-weight: bold;">100</span>)
</pre></div></div><br/></div><div><ul style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><b style="box-sizing: border-box; font-weight: 700;">Create or instantiate an object, e.g. lr = LinearRegression</b><img src="Linear%20Regression.resources/652F2837-762F-4E5A-986F-E298DF2D97F3.gif" height="1" width="1"/><img src="Linear%20Regression.resources/652F2837-762F-4E5A-986F-E298DF2D97F3.gif" height="1" width="1"/><img src="Linear%20Regression.resources/652F2837-762F-4E5A-986F-E298DF2D97F3.gif" height="1" width="1"/><br/></li></ul><div/><div style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><div style="box-sizing: border-box;"><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; padding: 9.5px; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px; font-weight: normal; font-style: normal;"><span style="box-sizing: border-box; color: rgb(136, 136, 136);"># 2. Create (or instantiate) an object of the model you want to build, e.g.</span>
lr <span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span> LinearRegression()
</pre></div></div></div><div><ul style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><b style="box-sizing: border-box; font-weight: 700;">Fit the model using the object, e.g.  lr.fit(X_train, y_train)</b></li></ul><div/><div style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><div style="box-sizing: border-box;"><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; padding: 9.5px; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px; font-weight: normal; font-style: normal;"><span style="box-sizing: border-box; color: rgb(136, 136, 136);"># 3. Fit the model using the training data </span>
lr<span style="box-sizing: border-box; color: rgb(51, 51, 51);">.</span>fit(X_train, y_train)
</pre></div></div></div><div><ul style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><b style="box-sizing: border-box; font-weight: 700;">Predict the labels of X_test, e.g. lr.predict(X_test)</b></li></ul><div/><div style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><div style="box-sizing: border-box;"><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; padding: 9.5px; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px; font-weight: normal; font-style: normal;"><span style="box-sizing: border-box; color: rgb(136, 136, 136);"># 4. Predict the labels using the test data X_test</span>
y_pred <span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span> lr<span style="box-sizing: border-box; color: rgb(51, 51, 51);">.</span>predict(X_test)
</pre></div></div></div><div><ul style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><b style="box-sizing: border-box; font-weight: 700;">Evaluate the model by comparing the predictions with the actual labels</b></li></ul><div/><div style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><div style="box-sizing: border-box;"><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; padding: 9.5px; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px; font-weight: normal; font-style: normal;"><span style="box-sizing: border-box; color: rgb(136, 136, 136);"># 5. Evaluate the model using an appropriate metric by comparing y_test and y_predicted</span>
r_squared <span style="box-sizing: border-box; color: rgb(51, 51, 51);">=</span> r2_score(y_test, y_pred)
</pre></div></div></div><div>np.newaxis</div><div><br/></div><div><br/></div><div>import numpy as np
</div><div>import pandas as pd
</div><div>import json
</div><div><br/></div><div>from sklearn import datasets, linear_model
</div><div>from sklearn.metrics import mean_squared_error, r2_score
</div><div><br/></div><div># reading the advertising dataset
</div><div>advertising = pd.read_csv("/data/training/advertising.csv")
</div><div><br/></div><div>## WRITE YOUR CODE HERE ##
</div><div><br/></div><div># subset only the columns 'TV' and 'Sales'
</div><div>tv_ads = advertising.loc[:, ['TV','Sales']]
</div><div><br/></div><div># split into X and Y
</div><div>X = tv_ads['TV'] 
</div><div>Y = tv_ads['Sales']
</div><div>print(type(X))
</div><div>print(type(Y))
</div><div><br/></div><div># convert pd series to np array
</div><div># the code has been written
</div><div>X_train = X[:, np.newaxis]
</div><div>Y_train = Y[:, np.newaxis]
</div><div><br/></div><div><br/></div><div># Build the model
</div><div><br/></div><div># import LinearRegression from sklearn
</div><div>from sklearn.linear_model import LinearRegression
</div><div><br/></div><div># Create a LinearRegression() object
</div><div>lr = LinearRegression()
</div><div><br/></div><div># fit the model using lr.fit()
</div><div>lr.fit(X_train, Y_train)
</div><div><br/></div><div><br/></div><div># printing the coeficients
</div><div>print(lr.intercept_)
</div><div>print(lr.coef_)
</div><div><br/></div><div># storing the coefficient and intercept in a dict
</div><div># the code is already written 
</div><div>output = {'coefficient': lr.coef_[0][0], 
</div><div>      'intercept': lr.intercept_[0]}
</div><div><br/></div><div>print(output)
</div><div><br/></div><div># writing the dictionary to output file
</div><div># code is already written
</div><div>with open('/code/output/ads.txt', 'w') as file:
</div><div>     file.write(json.dumps(output)) <br/></div><div><img src="Linear%20Regression.resources/Screen%20Shot%202018-06-09%20at%205.28.22%20AM.png" height="1136" width="1674"/><br/></div><div><br/></div><div><br/></div><div/><div><ul style="box-sizing: border-box; color: rgb(135, 135, 135); font-family: Lato, sans-serif; font-size: 14px; font-style: italic; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 254, 226); text-decoration-style: initial; text-decoration-color: initial;"><li style="">Choose a starting point <span style="box-sizing: border-box;"><span style="box-sizing: border-box; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 15.96px; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 1px 0px;"><span style="box-sizing: border-box; border-collapse: separate; border-spacing: 0px;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.442em; padding-bottom: 0.254em; padding-right: 0.024em;">X</span></span></span><span style="box-sizing: content-box !important; text-align: left; font-size: 11.2837px; vertical-align: -0.212em; padding-right: 0.071em;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.379em; padding-bottom: 0.379em;">0</span></span></span></span></span></span></span></span><span style="box-sizing: border-box; top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); user-select: none; padding: 1px 0px 0px !important; border: 0px !important; overflow: hidden !important;">X0</span></span></span></li><li style="">Beginning at <span style="box-sizing: border-box;"><span style="box-sizing: border-box; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 15.96px; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 1px 0px;"><span style="box-sizing: border-box; border-collapse: separate; border-spacing: 0px;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.442em; padding-bottom: 0.254em; padding-right: 0.024em;">X</span></span></span><span style="box-sizing: content-box !important; text-align: left; font-size: 11.2837px; vertical-align: -0.212em; padding-right: 0.071em;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.379em; padding-bottom: 0.379em;">0</span></span></span></span></span></span></span></span><span style="box-sizing: border-box; top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); user-select: none; padding: 1px 0px 0px !important; border: 0px !important; overflow: hidden !important;">X0</span></span></span>, generate a sequence of iterates<span style="box-sizing: border-box;"><span style="box-sizing: border-box; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 15.96px; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 1px 0px;"><span style="box-sizing: border-box; border-collapse: separate; border-spacing: 0px;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.442em; padding-bottom: 0.254em; padding-right: 0.024em;">X</span></span></span></span></span><span style="box-sizing: content-box !important; text-align: left; vertical-align: -0.335em;"><span style="box-sizing: content-box !important; text-align: left; font-size: 11.2837px; padding-bottom: 0.255em; padding-left: 0.115em; padding-right: 0.071em;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.442em; padding-bottom: 0.316em;">i</span></span><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.191em; padding-bottom: 0.316em;">n</span></span><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.504em; padding-bottom: 0.504em; padding-right: 0.06em;">f</span></span></span></span></span><span style="box-sizing: content-box !important; text-align: left; font-size: 11.2837px; padding-right: 0.071em;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.442em; padding-bottom: 0.316em;">k</span></span><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.066em; padding-bottom: 0.316em;">=</span></span><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.191em; padding-bottom: 0.316em;">o</span></span></span></span></span></span></span></span></span><span style="box-sizing: border-box; top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); user-select: none; padding: 1px 0px 0px !important; border: 0px !important; overflow: hidden !important;">Xk=oinf</span></span></span> with respect to a cost function <span style="box-sizing: border-box;"><span style="box-sizing: border-box; text-indent: 0px; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 15.96px; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 1px 0px;"><span style="box-sizing: border-box; border-collapse: separate; border-spacing: 0px;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.442em; padding-bottom: 0.567em;">(</span></span><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-math-I, MJXc-TeX-math-Ix, MJXc-TeX-math-Iw; padding-top: 0.504em; padding-bottom: 0.504em; padding-right: 0.06em;">f</span></span><span style="box-sizing: content-box !important; text-align: left;"><span style="box-sizing: content-box !important; text-align: left; white-space: pre; font-family: MJXc-TeX-main-R, MJXc-TeX-main-Rw; padding-top: 0.442em; padding-bottom: 0.567em;">)</span></span></span></span><span style="box-sizing: border-box; top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); user-select: none; padding: 1px 0px 0px !important; border: 0px !important; overflow: hidden !important;">(f)</span></span></span> value which has to be minimized until a solution with sufficient accuracy is found or until no further progress can be made.(inf=infinity)</li></ul><div style="orphans: 2; widows: 2;"><font face="Lato, sans-serif" color="#878787"><i><br/></i></font></div></div><div style="orphans: 2; widows: 2;"><font face="Lato, sans-serif" color="#878787"><i><font style="color: rgb(135, 135, 135); font-family: Lato;"><i><a href="http://mat.gsia.cmu.edu/classes/QUANT/NOTES/chap4.pdf">http://mat.gsia.cmu.edu/classes/QUANT/NOTES/chap4.pdf</a><span><a href="http://mat.gsia.cmu.edu/classes/QUANT/NOTES/chap4.pdf">    <span>    </span></a></span><a href="http://mat.gsia.cmu.edu/classes/QUANT/NOTES/chap4.pdf"/></i></font><br/></i></font></div><div><br/></div><div><span style="color: rgb(135, 135, 135); font-family: Lato, sans-serif; font-size: 14px; font-style: italic; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 254, 226); text-decoration-style: initial; text-decoration-color: initial; float: none;">An interesting property of L1 regularization is that model's parameters become sparse during optimization, i.e. it promotes a larger number of parameters w to be zero. This is because smaller weights are equally penalized as larger weights, whereas in L2 regularizations, larger weights are being penalized much more. This sparse property is often quite useful. For example, it might help us identify which features are more important for making predictions, or it might help us reduce the size of a model (the zero values don't need to be stored).</span><br/></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial; float: none;">To learn more about np.matmul, read the article </span><a style="box-sizing: border-box; background-color: rgb(245, 245, 245); color: rgb(51, 122, 183); text-decoration: none; font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" target="_blank" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html">here</a><span style="color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial; float: none;">.</span><br/></div><div><br/></div><div/><div><ul style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;" dir="ltr"><li style="">To know more about dummy variables (<a style="box-sizing: border-box; background-color: transparent; color: rgb(51, 122, 183); text-decoration: none;" href="https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faqwhat-is-dummy-coding">here</a>)</li><li style="">Why it's necessary to create dummy variables (<a style="box-sizing: border-box; background-color: transparent; color: rgb(51, 122, 183); text-decoration: none;" href="https://stats.stackexchange.com/questions/89533/convert-a-categorical-variable-to-a-numerical-variable-prior-to-regression">here</a>)</li><li style="">When to Normalise date and when to standardise? (<a style="box-sizing: border-box; background-color: transparent; color: rgb(51, 122, 183); text-decoration: none;" target="_blank" href="https://stackoverflow.com/questions/32108179/linear-regression-normalization-vs-standardization">here</a>)</li><li style="">Various scaling techniques (<a style="box-sizing: border-box; background-color: transparent; color: rgb(51, 122, 183); text-decoration: none;" target="_blank" href="https://en.wikipedia.org/wiki/Feature_scaling">here</a>)</li></ul></div><div><br/></div><div><h1 style="box-sizing: border-box; font-size: 24px; font-family: Merriweather, serif; font-weight: 700; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;">VIF - Variance Inflation Factor
</h1></div><div><p style="box-sizing: border-box; font-size: 16px; font-weight: 300; word-wrap: break-word; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;">To summarise, you learned the following important concepts:
</p><div/><ol style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;">Model building using p-Value and VIF</li><li style="box-sizing: border-box;">Why scaling of variables is important</li><li style="box-sizing: border-box;">Evaluation of model using r-squared and adjusted r-squared</li></ol></div><div><span style="color: rgb(51, 51, 51); font-family: q_serif_2, Georgia, Times, &quot;Times New Roman&quot;, &quot;Hiragino Kaku Gothic Pro&quot;, Meiryo, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; float: none;">Adjusted R square” comes to help. Adjusted R-square penalizes you for adding variables which do not improve your existing model.</span><br/></div><div><br/></div><div><br/></div><div>import numpy as np
</div><div>import pandas as pd
</div><div><br/></div><div>from sklearn import datasets, linear_model
</div><div>from sklearn.metrics import mean_squared_error, r2_score
</div><div><br/></div><div># read training data
</div><div>airquality_train = pd.read_csv("/data/training/airquality_train.csv")
</div><div><br/></div><div># read test data
</div><div>airquality_test = pd.read_csv("/data/test/airquality_test.csv")
</div><div><br/></div><div>print("This is what the training data looks like: \n")
</div><div>print(airquality_train.head())
</div><div>print("This is what the test data looks like: \n")
</div><div>print(airquality_test.head())
</div><div><br/></div><div># First, create the 'X' and 'Y' objects from the training data.
</div><div># You are required to type the indices in the 'iloc' command
</div><div># If you are unsure of the syntax, you can look up the documentation of pd.DataFrame and search for selecting columns
</div><div>x_train = airquality_train.iloc[:,1:4]# Type code to subset the predictor columns (X values)
</div><div>y_train = airquality_train.iloc[:,0]# Type code to subset the response column (Y values)
</div><div><br/></div><div><br/></div><div><br/></div><div># Now, go ahead and build the model.
</div><div># First, create the linear regression object
</div><div># You can do this by calling the LinearRegression() class. 
</div><div># If you are unsure about syntax, look up the documentation of sklearn.linear_model
</div><div>from sklearn.linear_model import LinearRegression
</div><div>lr = LinearRegression()
</div><div><br/></div><div># Now, run the command for fitting the model
</div><div>lr.fit(x_train, y_train)
</div><div><br/></div><div><br/></div><div># Now predict the target variable using the test dataset
</div><div>predictions = lr.predict(airquality_test.iloc[:,0:3]) #write your prediction function here. Predict on the X values of the test data
</div><div>print(predictions)
</div><div><br/></div><div># Now, write the columns id and predictions, into an output file
</div><div>output = pd.DataFrame({'id': airquality_test['id'], 'Ozone_Predicted': predictions})
</div><div>print("\n", "Your output is the following:", "\n", output.head())
</div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-family: Lato, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 700; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none;">RFE - Recursive Feature Elimination</span><br/></div><div><a href="http://blog.datadive.net/selecting-good-features-part-iv-stability-selection-rfe-and-everything-side-by-side/">http://blog.datadive.net/selecting-good-features-part-iv-stability-selection-rfe-and-everything-side-by-side/</a><br/></div><div><br/></div><div><p style="box-sizing: border-box; font-size: 16px; font-weight: 300; word-wrap: break-word; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;" dir="ltr">Let us recall all the steps we used throughout the linear regression model building process:
</p><div/><ol style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">Once you understood the business objective, you prepared the data, followed by EDA and the division of data into training and test datasets.
</p></li><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">The next step was the selection of variables for the creation of the model. Variable selection is critical because you cannot just include all the variables in the model; otherwise, you run the risk of including insignificant variables too.
</p></li><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">This is RFE can be used to quickly shortlist some variables which are significant to save time.
</p></li><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">However, these significant independent variables might be related to each other. This is where you need to check for multicollinearity amongst variables using variance inflation factor (VIF) and remove variables with high VIF and low significance (p&gt;0.05).
</p></li><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">The variables with a high VIF or multicollinearity may be statistically significant or p&lt;0.05, in which case you will first have to check for other insignificant variables (p&gt;0.05) before removing the variables with a higher VIF and lower p-values.
</p></li><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">Continue removing the variables until all variables are significant or p&lt;0.05, and have low VIFs.
</p></li><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">Finally you arrive at a model where all variables are significant and there is no threat of multicollinearity. 
</p></li><li style="box-sizing: border-box;" dir="ltr"><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;" dir="ltr">The final step is to check the model accuracy on the testing data.</p></li></ol></div><div><br/></div><div><img src="Linear%20Regression.resources/Screen%20Shot%202018-06-09%20at%204.41.42%20PM.png" height="1012" width="1608"/><br/></div><div><br/></div><div><p style="box-sizing: border-box; font-size: 16px; font-weight: 300; word-wrap: break-word; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;" dir="ltr">To read up on this topic further, here are some useful links:
</p><div/><ul style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Merriweather, serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;" dir="ltr"><li style="box-sizing: border-box;"><a style="box-sizing: border-box; background-color: transparent; color: rgb(51, 122, 183); text-decoration: none;" target="_blank" href="https://stats.stackexchange.com/questions/268638/confusion-about-parametric-and-non-parametric-model">Parametric v/s non parametric models in short</a></li><li style="box-sizing: border-box;"><a style="box-sizing: border-box; background-color: transparent; color: rgb(51, 122, 183); text-decoration: none;" target="_blank" href="http://machinelearningmastery.com/parametric-and-nonparametric-machine-learning-algorithms/">A detailed explanation on parametric and non-parametric models</a></li></ul><span>    </span><br/></div><div><span><img src="Linear%20Regression.resources/Screen%20Shot%202018-06-09%20at%205.03.40%20PM.png" height="888" width="1574"/><br/></span></div><div><div style="box-sizing: border-box; color: rgb(51, 51, 51); font-family: Lato, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><div style="box-sizing: border-box; padding-top: 2em; border-radius: 0px !important;"><div style="box-sizing: border-box;"><div style="box-sizing: border-box;"><div style="box-sizing: border-box; font-weight: 300; padding: 0.625em 0px; font-family: Merriweather, serif; font-size: 1em;"><h2 style="box-sizing: border-box; font-family: Lato, sans-serif; font-weight: 300 !important; color: rgb(155, 155, 155); font-size: 26px;">Additional reading
</h2><p style="box-sizing: border-box; font-size: 1em; font-weight: 300; word-wrap: break-word;">Read more about the bootstrap method <a style="box-sizing: border-box; background-color: transparent; color: rgb(51, 122, 183); text-decoration: none;" target="_blank" href="http://rstudio-pubs-static.s3.amazonaws.com/24365_2803ab8299934e888a60e7b16113f619.html">here</a>.
</p></div></div></div></div></div><div/><div style="box-sizing: border-box; cursor: pointer; color: rgb(155, 155, 155); font-family: Lato, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 245, 245); text-decoration-style: initial; text-decoration-color: initial;"><br/></div><br/></div><div><br/></div></body></html>